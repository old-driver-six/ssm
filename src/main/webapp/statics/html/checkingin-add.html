<!DOCTYPE html>
<html>

  <head>
      <meta charset="UTF-8">
      <title>添加考勤记录</title>
      <meta name="renderer" content="webkit">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
      <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
      <!-- layui等css -->
      <link rel="stylesheet" href="../css/font.css">
      <link rel="stylesheet" href="../css/xadmin.css">
      <link rel="stylesheet" href="../layui/css/layui.css" media="all">
      <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
      <script src="../js/jquery.min.js"></script>
      <script src="../js/jquery.cookie.js"></script>
      <script src="../layui/layui.js" charset="utf-8"></script>
      <script type="text/javascript" src="../js/xadmin.js"></script>

      <![endif]-->
      <script>
          layui.use(['layer','jquery', 'form','laydate'], function () {
              var $ = layui.jquery,
                      layer = layui.layer,
                      form = layui.form,
                      laydate = layui.laydate;


                  laydate.render({
                      elem: '#date' //指定元素
                      ,type: 'datetime'
                  });

              //自定义验证规则
                  form.verify({});

                  //监听提交
                  form.on('submit(add)', function (data) {
                      console.log(JSON.stringify(data.field));
                      $.ajax({
                          url:'/SaleServlet?method=insertSale',
                          type:"post",
                          data:{"insertSale":JSON.stringify(data.field)},
                          dataType:'json',
                          success:function (json) {
                              if (json.isSuccess) {
                                  $.ajax({
                                  url:'/SaleServlet?method=insertSaleDescription',
                                  type:"post",
                                  data:{"insertSale":JSON.stringify(data.field)},
                                  dataType:'json',
                                  success:function (json) {
                                      if (json.isSuccess) {
                                          layer.alert("增加成功", {icon: 6}, function () {
                                              // 获得frame索引
                                              var index = parent.layer.getFrameIndex(window.name);
                                              //关闭当前frame
                                              parent.layer.close(index);
                                              window.parent.location.reload();
                                          });
                                      } else {
                                          layer.alert("增加失败", {icon: 2}, function () {
                                              // 获得frame索引
                                              var index = parent.layer.getFrameIndex(window.name);
                                              //关闭当前frame
                                              parent.layer.close(index);
                                          })
                                      }}, error:function (e) {
                                      layer.msg('系统错误1', {icon: 2});
                                  }
                              });
                          }}, error:function (e) {
                              layer.msg('系统错误2', {icon: 2});
                          }
                      });

                      return false;
                  });
          });
      </script>
  </head>
  <body class="x-body">
  <form class="layui-form" action="">
      <div class="layui-form-item">
          <label  class="layui-form-label">
              <span class="x-red">*</span>财务人员
          </label>
          <div class="layui-input-inline">
              <input type="text" id="staffID" name="staffID" autocomplete="off" class="layui-input" required lay-verify="required" >
          </div>
      </div>


      <div class="layui-form-item">
          <label  for="staffID" class="layui-form-label">
              查看明细
          </label>
          <div class="layui-input-block">
              <button class="layui-btn"   onclick="x_admin_show('查询采购单','../html/bill-view.html',900)" type="button">查询订单</button>
              <button class="layui-btn"  onclick="x_admin_show('查询采购单','../html/purchase-view.html',700)" type="button">查询采购单</button>
          </div>
      </div>

      <div class="layui-form-item">
          <label  class="layui-form-label">
              <span class="x-red">*</span>收款金额
          </label>
          <div class="layui-input-inline">
              <input type="text" id="receiptMoney" name="receiptMoney" required lay-verify="required"
                     autocomplete="off" class="layui-input">
          </div>
      </div>
      <div class="layui-form-item">
          <label  class="layui-form-label">
              <span class="x-red">*</span>支出金额
          </label>
          <div class="layui-input-inline">
              <input type="text" id="spendMoney" name="spendMoney" required lay-verify="required"
                     autocomplete="off" class="layui-input">
          </div>
      </div>

          <div class="layui-form-item">
              <label  class="layui-form-label">
                  <span class="x-red">*</span>盈损金额
              </label>
              <div class="layui-input-inline">
                  <input type="text" id="profitAndLost" name="profitAndLost" required lay-verify="required"
                         autocomplete="off" class="layui-input">
              </div>
          </div>

      <div class="layui-form-item layui-form-text">
          <label for="saleDescription" class="layui-form-label">
              描述
          </label>
          <div class="layui-input-block">
              <textarea placeholder="请输入内容" id="saleDescription" name="saleDescription" class="layui-textarea" style="width: 600px;height: 280px"></textarea>
          </div>
      </div>

      <div class="layui-form-item layui-col-md12 x-so">
          <label   for="staffID" class="layui-form-label">
              <span class="x-red">*</span>统计时间
          </label>
          <input class="layui-input " placeholder="日期"  id="date"  name="date" required lay-verify="required">
      </div>

      <div class="layui-form-item">
          <label for="staffID" class="layui-form-label">
          </label>
          <button  class="layui-btn" lay-filter="add" lay-submit ="">
              增加
          </button>
      </div>
  </form>
  </body>
</html>