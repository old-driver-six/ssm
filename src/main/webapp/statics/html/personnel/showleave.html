<html>
<head>
    <meta charset="UTF-8">
    <title>显示请假条详情</title>
    <!--监听表单提交的js-->
    <link rel="stylesheet" href="../../layui/css/layui.css">
    <script src="../../js/jquery-3.1.1.js"></script>
    <script src="../../layui/layui.js"></script>
    <script src="../../js/basevalue.js"></script>
    <script>
        var id;
        var index;     //富文本对象的id
        var layedit;   //layui调用富文本的对象
        layui.use('layedit', function(){
            layedit = layui.layedit;
            index=layedit.build('demo'); //建立编辑器
        });
        $(function () {
            if(id){
                return;
            }
            id=setTimeout(function () {
           // alert($("#showJuit").html())
                //将请假内容显示在富文本编辑器中
                layedit.setContent(index,$("#showJuit").html());
            },100);
            $("#Preservation").on("click",function () {
                var $leaveId=$("#leaveId").val();           //请假条
                var $Title=$("#leaveTitle").val();       //获取到请假表题
                var $pressing=$("#pressing").val();      //请假紧急程度!
                var $LeaveNumber=$("#LeaveNumber").val();   //请假天数
                var $Type=$("#ltype").val();                //请假类型
                var $createDate=$("#date1").val();          //请假起始时间
                var $sendDate=$("#date2").val();            //请假结束时间
                var demo=layedit.getContent(index);         //获取到请假原因
                console.log("请假原因:"+demo);
                console.log("请假天数"+$LeaveNumber)
                $.ajax({
                    url:path+"/leave/update.do",
                    type:"post",
                    data:JSON.stringify({
                        "leaveProcessing":$pressing,
                        "leaveTitle":$Title,
                        "leaveType":$Type,
                        "leaveTime":$LeaveNumber,
                        "leaveStarttime":$createDate,
                        "leaveSendtime":$sendDate,
                        "leaveReason":demo,
                        "leaveId":$leaveId,
                    }),
                    contentType:"application/json;charset=utf-8",
                    dataType:'json',
                    success:function (e) {
                        console.log(e);
                        if(e.code==0){
                            layer.msg("修改成功！")
                        }else {
                            layer.msg(e.msg);
                        }
                    },
                    error:function (e) {
                        console.log(e);
                    }
                })
            })
            })
    </script>
    <style>
       .titleLeave{
           width: 200px;
           margin: 0 auto;
           text-align: center;
       }
        .titleLeave>h1{
            margin-top: 30px;
            font-family: 黑体;
            color: #578fe4;
        }
        .contextLeave{
            width: 1000px;
            margin: 50px auto;
        }
        .wth{
            width: 49%;
        }
        .selt{
            width: 150px;
            text-align: center;
            height: 30px;
        }
        .top{
            margin-top: 20px;
        }
        .contextLeave>h3{
            margin-left: 18px;
        }
    </style>
</head>
<body>
    <div class="leaveMain">
        <div class="titleLeave">
            <h1>请假申请详情</h1>
            <span>Leave application</span>
        </div>
        <div class="contextLeave">
            <div class="layui-inline wth" style="display: none">
                <label class="layui-form-label">请假条ID:</label>
                <div class="layui-input-inline">
                    <input type="text" id="leaveId" class="layui-input idle">
                </div>
            </div>
        <div class="contextLeave">
            <div class="layui-inline wth">
                <label class="layui-form-label">请假标题:</label>
                <div class="layui-input-inline">
                    <input type="text" id="leaveTitle" class="layui-input">
                </div>
            </div>
            <div class="layui-inline wth">
                <label class="layui-form-label">紧急程度:</label>
                <div class="layui-input-inline">
                    <select class="selt" id="pressing">
                        <option value="正常">正常</option>
                        <option value="紧急">紧急</option>
                        <option value="重要">重要</option>
                        <option value="其他">其他</option>
                    </select>
                </div>
            </div>

            <div class="layui-inline wth top">
                <label class="layui-form-label">请假天数:</label>
                <div class="layui-input-inline">
                    <input type="text" id="LeaveNumber" class="layui-input">
                </div>
            </div>
            <div class="layui-inline wth top">
                <label class="layui-form-label">请假类型:</label>
                <div class="layui-input-inline">
                    <select class="selt" id="ltype">
                        <option value="0">事假</option>
                        <option value="1">年假</option>
                        <option value="2">婚假</option>
                        <option value="3">产假</option>
                        <option value="3">病假</option>
                        <option value="3">其他</option>
                    </select>
                </div>
            </div>

            <div class="layui-inline wth top">
                <label class="layui-form-label" style="width: 100px">请假起始日期:</label>
                <div class="layui-input-inline">
                    <input type="date" id="date1">
                </div>
            </div>
            <div class="layui-inline wth top">
                <label class="layui-form-label" style="width: 100px">请假结束日期:</label>
                <div class="layui-input-inline">
                    <input type="date" id="date2">
                </div>
            </div>
            <h3 class="top">请假原因:</h3>
            <div class="top">
                <textarea id="demo"></textarea>
            </div>
            <div id="showJuit" style="display: none;"></div>
            <div class="top">
                <button class="layui-btn layui-btn-normal" id="Preservation" type="button">修改请假条</button>
            </div>
         </div>
    </div>
</body>
</html>